{"version":3,"file":"torus-connector.esm.js","sources":["../src/index.ts"],"sourcesContent":["import { ConnectorUpdate } from '@web3-react/types'\nimport { AbstractConnector } from '@web3-react/abstract-connector'\n\ninterface TorusConnectorArguments {\n  chainId: number\n  initOptions?: any\n  constructorOptions?: any\n  loginOptions?: any\n}\n\nexport class TorusConnector extends AbstractConnector {\n  private readonly chainId: number\n  private readonly initOptions: any\n  private readonly constructorOptions: any\n  private readonly loginOptions: any\n\n  public torus: any\n\n  constructor({ chainId, initOptions = {}, constructorOptions = {}, loginOptions = {} }: TorusConnectorArguments) {\n    super({ supportedChainIds: [chainId] })\n\n    this.chainId = chainId\n    this.initOptions = initOptions\n    this.constructorOptions = constructorOptions\n    this.loginOptions = loginOptions\n  }\n\n  public async activate(): Promise<ConnectorUpdate> {\n    if (!this.torus) {\n      const { default: Torus } = await import('@toruslabs/torus-embed')\n      this.torus = new Torus(this.constructorOptions)\n      await this.torus.init(this.initOptions)\n    }\n\n    const account = await this.torus.login(this.loginOptions).then((accounts: string[]): string => accounts[0])\n\n    return { provider: this.torus.provider, account }\n  }\n\n  public async getProvider(): Promise<any> {\n    return this.torus.provider\n  }\n\n  public async getChainId(): Promise<number | string> {\n    return this.chainId\n  }\n\n  public async getAccount(): Promise<null | string> {\n    return this.torus.ethereum.send('eth_accounts').then((accounts: string[]): string => accounts[0])\n  }\n\n  public async deactivate() {\n    await this.torus.cleanUp()\n    this.torus = undefined\n  }\n\n  public async close() {\n    await this.torus.logout()\n    this.emitDeactivate()\n  }\n}\n"],"names":["TorusConnector","chainId","initOptions","constructorOptions","loginOptions","supportedChainIds","activate","torus","login","then","accounts","account","provider","Torus","init","getProvider","getChainId","getAccount","ethereum","send","deactivate","cleanUp","undefined","close","logout","emitDeactivate","AbstractConnector"],"mappings":";;;;;;;;IAUaA,cAAb;AAAA;;AAQE;;;QAAcC,eAAAA;gCAASC;QAAAA,4CAAc;qCAAIC;QAAAA,wDAAqB;iCAAIC;QAAAA,8CAAe;AAC/E,0CAAM;AAAEC,MAAAA,iBAAiB,EAAE,CAACJ,OAAD;AAArB,KAAN;AAEA,UAAKA,OAAL,GAAeA,OAAf;AACA,UAAKC,WAAL,GAAmBA,WAAnB;AACA,UAAKC,kBAAL,GAA0BA,kBAA1B;AACA,UAAKC,YAAL,GAAoBA,YAApB;;AACD;;AAfH;;AAAA,SAiBeE,QAjBf;AAAA;;+BAwB0B,OAAKC,KAAL,CAAWC,KAAX,CAAiB,OAAKJ,YAAtB,EAAoCK,IAApC,CAAyC,UAACC,QAAD;AAAA,iBAAgCA,QAAQ,CAAC,CAAD,CAAxC;AAAA,SAAzC,kBAAhBC;AAEN,iBAAO;AAAEC,YAAAA,QAAQ,EAAE,OAAKL,KAAL,CAAWK,QAAvB;AAAiCD,YAAAA,OAAO,EAAPA;AAAjC,WAAP;;;;mBARK;;;YAAD,CAAC,OAAKJ;iCACyB,OAAO,wBAAP;gBAAhBM;AACjB,mBAAKN,KAAL,GAAa,IAAIM,KAAJ,CAAU,OAAKV,kBAAf,CAAb;mCACM,OAAKI,KAAL,CAAWO,IAAX,CAAgB,OAAKZ,WAArB;;;;;;AAMT,KA3BH;AAAA;AAAA;AAAA;;AAAA,SA6Bea,WA7Bf;AAAA;mBA8BW;;AAAP,6BAAO,OAAKR,KAAL,CAAWK,QAAlB;AACD,KA/BH;AAAA;AAAA;AAAA;;AAAA,SAiCeI,UAjCf;AAAA;mBAkCW;;AAAP,6BAAO,OAAKf,OAAZ;AACD,KAnCH;AAAA;AAAA;AAAA;;AAAA,SAqCegB,UArCf;AAAA;mBAsCW;;AAAP,6BAAO,OAAKV,KAAL,CAAWW,QAAX,CAAoBC,IAApB,CAAyB,cAAzB,EAAyCV,IAAzC,CAA8C,UAACC,QAAD;AAAA,eAAgCA,QAAQ,CAAC,CAAD,CAAxC;AAAA,OAA9C,CAAP;AACD,KAvCH;AAAA;AAAA;AAAA;;AAAA,SAyCeU,UAzCf;AAAA;oBA0CU;;6BAAA,QAAKb,KAAL,CAAWc,OAAX;AACN,gBAAKd,KAAL,GAAae,SAAb;;AACD,KA5CH;AAAA;AAAA;AAAA;;AAAA,SA8CeC,KA9Cf;AAAA;oBA+CU;;6BAAA,QAAKhB,KAAL,CAAWiB,MAAX;AACN,gBAAKC,cAAL;;AACD,KAjDH;AAAA;AAAA;AAAA;;AAAA;AAAA,EAAoCC,iBAApC;;;;"}