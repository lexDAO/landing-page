{"ast":null,"code":"'use strict';\n\nexports.__esModule = true;\nexports.checkRevision = checkRevision;\nexports.template = template;\nexports.wrapProgram = wrapProgram;\nexports.resolvePartial = resolvePartial;\nexports.invokePartial = invokePartial;\nexports.noop = noop; // istanbul ignore next\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    'default': obj\n  };\n} // istanbul ignore next\n\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj['default'] = obj;\n    return newObj;\n  }\n}\n\nvar _utils = require('./utils');\n\nvar Utils = _interopRequireWildcard(_utils);\n\nvar _exception = require('./exception');\n\nvar _exception2 = _interopRequireDefault(_exception);\n\nvar _base = require('./base');\n\nvar _helpers = require('./helpers');\n\nvar _internalWrapHelper = require('./internal/wrapHelper');\n\nvar _internalProtoAccess = require('./internal/proto-access');\n\nfunction checkRevision(compilerInfo) {\n  var compilerRevision = compilerInfo && compilerInfo[0] || 1,\n      currentRevision = _base.COMPILER_REVISION;\n\n  if (compilerRevision >= _base.LAST_COMPATIBLE_COMPILER_REVISION && compilerRevision <= _base.COMPILER_REVISION) {\n    return;\n  }\n\n  if (compilerRevision < _base.LAST_COMPATIBLE_COMPILER_REVISION) {\n    var runtimeVersions = _base.REVISION_CHANGES[currentRevision],\n        compilerVersions = _base.REVISION_CHANGES[compilerRevision];\n    throw new _exception2['default']('Template was precompiled with an older version of Handlebars than the current runtime. ' + 'Please update your precompiler to a newer version (' + runtimeVersions + ') or downgrade your runtime to an older version (' + compilerVersions + ').');\n  } else {\n    // Use the embedded version info since the runtime doesn't know about this revision yet\n    throw new _exception2['default']('Template was precompiled with a newer version of Handlebars than the current runtime. ' + 'Please update your runtime to a newer version (' + compilerInfo[1] + ').');\n  }\n}\n\nfunction template(templateSpec, env) {\n  /* istanbul ignore next */\n  if (!env) {\n    throw new _exception2['default']('No environment passed to template');\n  }\n\n  if (!templateSpec || !templateSpec.main) {\n    throw new _exception2['default']('Unknown template object: ' + typeof templateSpec);\n  }\n\n  templateSpec.main.decorator = templateSpec.main_d; // Note: Using env.VM references rather than local var references throughout this section to allow\n  // for external users to override these as pseudo-supported APIs.\n\n  env.VM.checkRevision(templateSpec.compiler); // backwards compatibility for precompiled templates with compiler-version 7 (<4.3.0)\n\n  var templateWasPrecompiledWithCompilerV7 = templateSpec.compiler && templateSpec.compiler[0] === 7;\n\n  function invokePartialWrapper(partial, context, options) {\n    if (options.hash) {\n      context = Utils.extend({}, context, options.hash);\n\n      if (options.ids) {\n        options.ids[0] = true;\n      }\n    }\n\n    partial = env.VM.resolvePartial.call(this, partial, context, options);\n    var extendedOptions = Utils.extend({}, options, {\n      hooks: this.hooks,\n      protoAccessControl: this.protoAccessControl\n    });\n    var result = env.VM.invokePartial.call(this, partial, context, extendedOptions);\n\n    if (result == null && env.compile) {\n      options.partials[options.name] = env.compile(partial, templateSpec.compilerOptions, env);\n      result = options.partials[options.name](context, extendedOptions);\n    }\n\n    if (result != null) {\n      if (options.indent) {\n        var lines = result.split('\\n');\n\n        for (var i = 0, l = lines.length; i < l; i++) {\n          if (!lines[i] && i + 1 === l) {\n            break;\n          }\n\n          lines[i] = options.indent + lines[i];\n        }\n\n        result = lines.join('\\n');\n      }\n\n      return result;\n    } else {\n      throw new _exception2['default']('The partial ' + options.name + ' could not be compiled when running in runtime-only mode');\n    }\n  } // Just add water\n\n\n  var container = {\n    strict: function strict(obj, name, loc) {\n      if (!obj || !(name in obj)) {\n        throw new _exception2['default']('\"' + name + '\" not defined in ' + obj, {\n          loc: loc\n        });\n      }\n\n      return obj[name];\n    },\n    lookupProperty: function lookupProperty(parent, propertyName) {\n      var result = parent[propertyName];\n\n      if (result == null) {\n        return result;\n      }\n\n      if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n        return result;\n      }\n\n      if (_internalProtoAccess.resultIsAllowed(result, container.protoAccessControl, propertyName)) {\n        return result;\n      }\n\n      return undefined;\n    },\n    lookup: function lookup(depths, name) {\n      var len = depths.length;\n\n      for (var i = 0; i < len; i++) {\n        var result = depths[i] && container.lookupProperty(depths[i], name);\n\n        if (result != null) {\n          return depths[i][name];\n        }\n      }\n    },\n    lambda: function lambda(current, context) {\n      return typeof current === 'function' ? current.call(context) : current;\n    },\n    escapeExpression: Utils.escapeExpression,\n    invokePartial: invokePartialWrapper,\n    fn: function fn(i) {\n      var ret = templateSpec[i];\n      ret.decorator = templateSpec[i + '_d'];\n      return ret;\n    },\n    programs: [],\n    program: function program(i, data, declaredBlockParams, blockParams, depths) {\n      var programWrapper = this.programs[i],\n          fn = this.fn(i);\n\n      if (data || depths || blockParams || declaredBlockParams) {\n        programWrapper = wrapProgram(this, i, fn, data, declaredBlockParams, blockParams, depths);\n      } else if (!programWrapper) {\n        programWrapper = this.programs[i] = wrapProgram(this, i, fn);\n      }\n\n      return programWrapper;\n    },\n    data: function data(value, depth) {\n      while (value && depth--) {\n        value = value._parent;\n      }\n\n      return value;\n    },\n    mergeIfNeeded: function mergeIfNeeded(param, common) {\n      var obj = param || common;\n\n      if (param && common && param !== common) {\n        obj = Utils.extend({}, common, param);\n      }\n\n      return obj;\n    },\n    // An empty object to use as replacement for null-contexts\n    nullContext: Object.seal({}),\n    noop: env.VM.noop,\n    compilerInfo: templateSpec.compiler\n  };\n\n  function ret(context) {\n    var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n    var data = options.data;\n\n    ret._setup(options);\n\n    if (!options.partial && templateSpec.useData) {\n      data = initData(context, data);\n    }\n\n    var depths = undefined,\n        blockParams = templateSpec.useBlockParams ? [] : undefined;\n\n    if (templateSpec.useDepths) {\n      if (options.depths) {\n        depths = context != options.depths[0] ? [context].concat(options.depths) : options.depths;\n      } else {\n        depths = [context];\n      }\n    }\n\n    function main(context\n    /*, options*/\n    ) {\n      return '' + templateSpec.main(container, context, container.helpers, container.partials, data, blockParams, depths);\n    }\n\n    main = executeDecorators(templateSpec.main, main, container, options.depths || [], data, blockParams);\n    return main(context, options);\n  }\n\n  ret.isTop = true;\n\n  ret._setup = function (options) {\n    if (!options.partial) {\n      var mergedHelpers = Utils.extend({}, env.helpers, options.helpers);\n      wrapHelpersToPassLookupProperty(mergedHelpers, container);\n      container.helpers = mergedHelpers;\n\n      if (templateSpec.usePartial) {\n        // Use mergeIfNeeded here to prevent compiling global partials multiple times\n        container.partials = container.mergeIfNeeded(options.partials, env.partials);\n      }\n\n      if (templateSpec.usePartial || templateSpec.useDecorators) {\n        container.decorators = Utils.extend({}, env.decorators, options.decorators);\n      }\n\n      container.hooks = {};\n      container.protoAccessControl = _internalProtoAccess.createProtoAccessControl(options);\n      var keepHelperInHelpers = options.allowCallsToHelperMissing || templateWasPrecompiledWithCompilerV7;\n\n      _helpers.moveHelperToHooks(container, 'helperMissing', keepHelperInHelpers);\n\n      _helpers.moveHelperToHooks(container, 'blockHelperMissing', keepHelperInHelpers);\n    } else {\n      container.protoAccessControl = options.protoAccessControl; // internal option\n\n      container.helpers = options.helpers;\n      container.partials = options.partials;\n      container.decorators = options.decorators;\n      container.hooks = options.hooks;\n    }\n  };\n\n  ret._child = function (i, data, blockParams, depths) {\n    if (templateSpec.useBlockParams && !blockParams) {\n      throw new _exception2['default']('must pass block params');\n    }\n\n    if (templateSpec.useDepths && !depths) {\n      throw new _exception2['default']('must pass parent depths');\n    }\n\n    return wrapProgram(container, i, templateSpec[i], data, 0, blockParams, depths);\n  };\n\n  return ret;\n}\n\nfunction wrapProgram(container, i, fn, data, declaredBlockParams, blockParams, depths) {\n  function prog(context) {\n    var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n    var currentDepths = depths;\n\n    if (depths && context != depths[0] && !(context === container.nullContext && depths[0] === null)) {\n      currentDepths = [context].concat(depths);\n    }\n\n    return fn(container, context, container.helpers, container.partials, options.data || data, blockParams && [options.blockParams].concat(blockParams), currentDepths);\n  }\n\n  prog = executeDecorators(fn, prog, container, depths, data, blockParams);\n  prog.program = i;\n  prog.depth = depths ? depths.length : 0;\n  prog.blockParams = declaredBlockParams || 0;\n  return prog;\n}\n/**\n * This is currently part of the official API, therefore implementation details should not be changed.\n */\n\n\nfunction resolvePartial(partial, context, options) {\n  if (!partial) {\n    if (options.name === '@partial-block') {\n      partial = options.data['partial-block'];\n    } else {\n      partial = options.partials[options.name];\n    }\n  } else if (!partial.call && !options.name) {\n    // This is a dynamic partial that returned a string\n    options.name = partial;\n    partial = options.partials[partial];\n  }\n\n  return partial;\n}\n\nfunction invokePartial(partial, context, options) {\n  // Use the current closure context to save the partial-block if this partial\n  var currentPartialBlock = options.data && options.data['partial-block'];\n  options.partial = true;\n\n  if (options.ids) {\n    options.data.contextPath = options.ids[0] || options.data.contextPath;\n  }\n\n  var partialBlock = undefined;\n\n  if (options.fn && options.fn !== noop) {\n    (function () {\n      options.data = _base.createFrame(options.data); // Wrapper function to get access to currentPartialBlock from the closure\n\n      var fn = options.fn;\n\n      partialBlock = options.data['partial-block'] = function partialBlockWrapper(context) {\n        var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1]; // Restore the partial-block from the closure for the execution of the block\n        // i.e. the part inside the block of the partial call.\n\n        options.data = _base.createFrame(options.data);\n        options.data['partial-block'] = currentPartialBlock;\n        return fn(context, options);\n      };\n\n      if (fn.partials) {\n        options.partials = Utils.extend({}, options.partials, fn.partials);\n      }\n    })();\n  }\n\n  if (partial === undefined && partialBlock) {\n    partial = partialBlock;\n  }\n\n  if (partial === undefined) {\n    throw new _exception2['default']('The partial ' + options.name + ' could not be found');\n  } else if (partial instanceof Function) {\n    return partial(context, options);\n  }\n}\n\nfunction noop() {\n  return '';\n}\n\nfunction initData(context, data) {\n  if (!data || !('root' in data)) {\n    data = data ? _base.createFrame(data) : {};\n    data.root = context;\n  }\n\n  return data;\n}\n\nfunction executeDecorators(fn, prog, container, depths, data, blockParams) {\n  if (fn.decorator) {\n    var props = {};\n    prog = fn.decorator(prog, props, container, depths && depths[0], data, blockParams, depths);\n    Utils.extend(prog, props);\n  }\n\n  return prog;\n}\n\nfunction wrapHelpersToPassLookupProperty(mergedHelpers, container) {\n  Object.keys(mergedHelpers).forEach(function (helperName) {\n    var helper = mergedHelpers[helperName];\n    mergedHelpers[helperName] = passLookupPropertyOption(helper, container);\n  });\n}\n\nfunction passLookupPropertyOption(helper, container) {\n  var lookupProperty = container.lookupProperty;\n  return _internalWrapHelper.wrapHelper(helper, function (options) {\n    return Utils.extend({\n      lookupProperty: lookupProperty\n    }, options);\n  });\n}","map":{"version":3,"sources":["../../../lib/handlebars/runtime.js"],"names":[],"mappings":"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","sourcesContent":["import * as Utils from './utils';\nimport Exception from './exception';\nimport {\n  COMPILER_REVISION,\n  createFrame,\n  LAST_COMPATIBLE_COMPILER_REVISION,\n  REVISION_CHANGES\n} from './base';\nimport { moveHelperToHooks } from './helpers';\nimport { wrapHelper } from './internal/wrapHelper';\nimport {\n  createProtoAccessControl,\n  resultIsAllowed\n} from './internal/proto-access';\n\nexport function checkRevision(compilerInfo) {\n  const compilerRevision = (compilerInfo && compilerInfo[0]) || 1,\n    currentRevision = COMPILER_REVISION;\n\n  if (\n    compilerRevision >= LAST_COMPATIBLE_COMPILER_REVISION &&\n    compilerRevision <= COMPILER_REVISION\n  ) {\n    return;\n  }\n\n  if (compilerRevision < LAST_COMPATIBLE_COMPILER_REVISION) {\n    const runtimeVersions = REVISION_CHANGES[currentRevision],\n      compilerVersions = REVISION_CHANGES[compilerRevision];\n    throw new Exception(\n      'Template was precompiled with an older version of Handlebars than the current runtime. ' +\n        'Please update your precompiler to a newer version (' +\n        runtimeVersions +\n        ') or downgrade your runtime to an older version (' +\n        compilerVersions +\n        ').'\n    );\n  } else {\n    // Use the embedded version info since the runtime doesn't know about this revision yet\n    throw new Exception(\n      'Template was precompiled with a newer version of Handlebars than the current runtime. ' +\n        'Please update your runtime to a newer version (' +\n        compilerInfo[1] +\n        ').'\n    );\n  }\n}\n\nexport function template(templateSpec, env) {\n  /* istanbul ignore next */\n  if (!env) {\n    throw new Exception('No environment passed to template');\n  }\n  if (!templateSpec || !templateSpec.main) {\n    throw new Exception('Unknown template object: ' + typeof templateSpec);\n  }\n\n  templateSpec.main.decorator = templateSpec.main_d;\n\n  // Note: Using env.VM references rather than local var references throughout this section to allow\n  // for external users to override these as pseudo-supported APIs.\n  env.VM.checkRevision(templateSpec.compiler);\n\n  // backwards compatibility for precompiled templates with compiler-version 7 (<4.3.0)\n  const templateWasPrecompiledWithCompilerV7 =\n    templateSpec.compiler && templateSpec.compiler[0] === 7;\n\n  function invokePartialWrapper(partial, context, options) {\n    if (options.hash) {\n      context = Utils.extend({}, context, options.hash);\n      if (options.ids) {\n        options.ids[0] = true;\n      }\n    }\n    partial = env.VM.resolvePartial.call(this, partial, context, options);\n\n    let extendedOptions = Utils.extend({}, options, {\n      hooks: this.hooks,\n      protoAccessControl: this.protoAccessControl\n    });\n\n    let result = env.VM.invokePartial.call(\n      this,\n      partial,\n      context,\n      extendedOptions\n    );\n\n    if (result == null && env.compile) {\n      options.partials[options.name] = env.compile(\n        partial,\n        templateSpec.compilerOptions,\n        env\n      );\n      result = options.partials[options.name](context, extendedOptions);\n    }\n    if (result != null) {\n      if (options.indent) {\n        let lines = result.split('\\n');\n        for (let i = 0, l = lines.length; i < l; i++) {\n          if (!lines[i] && i + 1 === l) {\n            break;\n          }\n\n          lines[i] = options.indent + lines[i];\n        }\n        result = lines.join('\\n');\n      }\n      return result;\n    } else {\n      throw new Exception(\n        'The partial ' +\n          options.name +\n          ' could not be compiled when running in runtime-only mode'\n      );\n    }\n  }\n\n  // Just add water\n  let container = {\n    strict: function(obj, name, loc) {\n      if (!obj || !(name in obj)) {\n        throw new Exception('\"' + name + '\" not defined in ' + obj, {\n          loc: loc\n        });\n      }\n      return obj[name];\n    },\n    lookupProperty: function(parent, propertyName) {\n      let result = parent[propertyName];\n      if (result == null) {\n        return result;\n      }\n      if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n        return result;\n      }\n\n      if (resultIsAllowed(result, container.protoAccessControl, propertyName)) {\n        return result;\n      }\n      return undefined;\n    },\n    lookup: function(depths, name) {\n      const len = depths.length;\n      for (let i = 0; i < len; i++) {\n        let result = depths[i] && container.lookupProperty(depths[i], name);\n        if (result != null) {\n          return depths[i][name];\n        }\n      }\n    },\n    lambda: function(current, context) {\n      return typeof current === 'function' ? current.call(context) : current;\n    },\n\n    escapeExpression: Utils.escapeExpression,\n    invokePartial: invokePartialWrapper,\n\n    fn: function(i) {\n      let ret = templateSpec[i];\n      ret.decorator = templateSpec[i + '_d'];\n      return ret;\n    },\n\n    programs: [],\n    program: function(i, data, declaredBlockParams, blockParams, depths) {\n      let programWrapper = this.programs[i],\n        fn = this.fn(i);\n      if (data || depths || blockParams || declaredBlockParams) {\n        programWrapper = wrapProgram(\n          this,\n          i,\n          fn,\n          data,\n          declaredBlockParams,\n          blockParams,\n          depths\n        );\n      } else if (!programWrapper) {\n        programWrapper = this.programs[i] = wrapProgram(this, i, fn);\n      }\n      return programWrapper;\n    },\n\n    data: function(value, depth) {\n      while (value && depth--) {\n        value = value._parent;\n      }\n      return value;\n    },\n    mergeIfNeeded: function(param, common) {\n      let obj = param || common;\n\n      if (param && common && param !== common) {\n        obj = Utils.extend({}, common, param);\n      }\n\n      return obj;\n    },\n    // An empty object to use as replacement for null-contexts\n    nullContext: Object.seal({}),\n\n    noop: env.VM.noop,\n    compilerInfo: templateSpec.compiler\n  };\n\n  function ret(context, options = {}) {\n    let data = options.data;\n\n    ret._setup(options);\n    if (!options.partial && templateSpec.useData) {\n      data = initData(context, data);\n    }\n    let depths,\n      blockParams = templateSpec.useBlockParams ? [] : undefined;\n    if (templateSpec.useDepths) {\n      if (options.depths) {\n        depths =\n          context != options.depths[0]\n            ? [context].concat(options.depths)\n            : options.depths;\n      } else {\n        depths = [context];\n      }\n    }\n\n    function main(context /*, options*/) {\n      return (\n        '' +\n        templateSpec.main(\n          container,\n          context,\n          container.helpers,\n          container.partials,\n          data,\n          blockParams,\n          depths\n        )\n      );\n    }\n\n    main = executeDecorators(\n      templateSpec.main,\n      main,\n      container,\n      options.depths || [],\n      data,\n      blockParams\n    );\n    return main(context, options);\n  }\n\n  ret.isTop = true;\n\n  ret._setup = function(options) {\n    if (!options.partial) {\n      let mergedHelpers = Utils.extend({}, env.helpers, options.helpers);\n      wrapHelpersToPassLookupProperty(mergedHelpers, container);\n      container.helpers = mergedHelpers;\n\n      if (templateSpec.usePartial) {\n        // Use mergeIfNeeded here to prevent compiling global partials multiple times\n        container.partials = container.mergeIfNeeded(\n          options.partials,\n          env.partials\n        );\n      }\n      if (templateSpec.usePartial || templateSpec.useDecorators) {\n        container.decorators = Utils.extend(\n          {},\n          env.decorators,\n          options.decorators\n        );\n      }\n\n      container.hooks = {};\n      container.protoAccessControl = createProtoAccessControl(options);\n\n      let keepHelperInHelpers =\n        options.allowCallsToHelperMissing ||\n        templateWasPrecompiledWithCompilerV7;\n      moveHelperToHooks(container, 'helperMissing', keepHelperInHelpers);\n      moveHelperToHooks(container, 'blockHelperMissing', keepHelperInHelpers);\n    } else {\n      container.protoAccessControl = options.protoAccessControl; // internal option\n      container.helpers = options.helpers;\n      container.partials = options.partials;\n      container.decorators = options.decorators;\n      container.hooks = options.hooks;\n    }\n  };\n\n  ret._child = function(i, data, blockParams, depths) {\n    if (templateSpec.useBlockParams && !blockParams) {\n      throw new Exception('must pass block params');\n    }\n    if (templateSpec.useDepths && !depths) {\n      throw new Exception('must pass parent depths');\n    }\n\n    return wrapProgram(\n      container,\n      i,\n      templateSpec[i],\n      data,\n      0,\n      blockParams,\n      depths\n    );\n  };\n  return ret;\n}\n\nexport function wrapProgram(\n  container,\n  i,\n  fn,\n  data,\n  declaredBlockParams,\n  blockParams,\n  depths\n) {\n  function prog(context, options = {}) {\n    let currentDepths = depths;\n    if (\n      depths &&\n      context != depths[0] &&\n      !(context === container.nullContext && depths[0] === null)\n    ) {\n      currentDepths = [context].concat(depths);\n    }\n\n    return fn(\n      container,\n      context,\n      container.helpers,\n      container.partials,\n      options.data || data,\n      blockParams && [options.blockParams].concat(blockParams),\n      currentDepths\n    );\n  }\n\n  prog = executeDecorators(fn, prog, container, depths, data, blockParams);\n\n  prog.program = i;\n  prog.depth = depths ? depths.length : 0;\n  prog.blockParams = declaredBlockParams || 0;\n  return prog;\n}\n\n/**\n * This is currently part of the official API, therefore implementation details should not be changed.\n */\nexport function resolvePartial(partial, context, options) {\n  if (!partial) {\n    if (options.name === '@partial-block') {\n      partial = options.data['partial-block'];\n    } else {\n      partial = options.partials[options.name];\n    }\n  } else if (!partial.call && !options.name) {\n    // This is a dynamic partial that returned a string\n    options.name = partial;\n    partial = options.partials[partial];\n  }\n  return partial;\n}\n\nexport function invokePartial(partial, context, options) {\n  // Use the current closure context to save the partial-block if this partial\n  const currentPartialBlock = options.data && options.data['partial-block'];\n  options.partial = true;\n  if (options.ids) {\n    options.data.contextPath = options.ids[0] || options.data.contextPath;\n  }\n\n  let partialBlock;\n  if (options.fn && options.fn !== noop) {\n    options.data = createFrame(options.data);\n    // Wrapper function to get access to currentPartialBlock from the closure\n    let fn = options.fn;\n    partialBlock = options.data['partial-block'] = function partialBlockWrapper(\n      context,\n      options = {}\n    ) {\n      // Restore the partial-block from the closure for the execution of the block\n      // i.e. the part inside the block of the partial call.\n      options.data = createFrame(options.data);\n      options.data['partial-block'] = currentPartialBlock;\n      return fn(context, options);\n    };\n    if (fn.partials) {\n      options.partials = Utils.extend({}, options.partials, fn.partials);\n    }\n  }\n\n  if (partial === undefined && partialBlock) {\n    partial = partialBlock;\n  }\n\n  if (partial === undefined) {\n    throw new Exception('The partial ' + options.name + ' could not be found');\n  } else if (partial instanceof Function) {\n    return partial(context, options);\n  }\n}\n\nexport function noop() {\n  return '';\n}\n\nfunction initData(context, data) {\n  if (!data || !('root' in data)) {\n    data = data ? createFrame(data) : {};\n    data.root = context;\n  }\n  return data;\n}\n\nfunction executeDecorators(fn, prog, container, depths, data, blockParams) {\n  if (fn.decorator) {\n    let props = {};\n    prog = fn.decorator(\n      prog,\n      props,\n      container,\n      depths && depths[0],\n      data,\n      blockParams,\n      depths\n    );\n    Utils.extend(prog, props);\n  }\n  return prog;\n}\n\nfunction wrapHelpersToPassLookupProperty(mergedHelpers, container) {\n  Object.keys(mergedHelpers).forEach(helperName => {\n    let helper = mergedHelpers[helperName];\n    mergedHelpers[helperName] = passLookupPropertyOption(helper, container);\n  });\n}\n\nfunction passLookupPropertyOption(helper, container) {\n  const lookupProperty = container.lookupProperty;\n  return wrapHelper(helper, options => {\n    return Utils.extend({ lookupProperty }, options);\n  });\n}\n"]},"metadata":{},"sourceType":"script"}