{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar ethUtil = require(\"ethereumjs-util\");\n\nvar constants_1 = require(\"../../utils/constants\");\n\nvar calldata_block_1 = require(\"../calldata_block\");\n\nvar PointerCalldataBlock =\n/** @class */\nfunction (_super) {\n  __extends(PointerCalldataBlock, _super);\n\n  function PointerCalldataBlock(name, signature, parentName, dependency, parent) {\n    var _this = this;\n\n    var headerSizeInBytes = PointerCalldataBlock._EMPTY_HEADER_SIZE;\n    var bodySizeInBytes = PointerCalldataBlock._DEPENDENT_PAYLOAD_SIZE_IN_BYTES;\n    _this = _super.call(this, name, signature, parentName, headerSizeInBytes, bodySizeInBytes) || this;\n    _this._parent = parent;\n    _this._dependency = dependency;\n    _this._aliasFor = undefined;\n    return _this;\n  }\n\n  PointerCalldataBlock.prototype.toBuffer = function () {\n    var destinationOffset = this._aliasFor !== undefined ? this._aliasFor.getOffsetInBytes() : this._dependency.getOffsetInBytes();\n\n    var parentOffset = this._parent.getOffsetInBytes();\n\n    var parentHeaderSize = this._parent.getHeaderSizeInBytes();\n\n    var pointer = destinationOffset - (parentOffset + parentHeaderSize);\n    var pointerHex = \"0x\" + pointer.toString(constants_1.constants.HEX_BASE);\n    var pointerBuf = ethUtil.toBuffer(pointerHex);\n    var pointerBufPadded = ethUtil.setLengthLeft(pointerBuf, constants_1.constants.EVM_WORD_WIDTH_IN_BYTES);\n    return pointerBufPadded;\n  };\n\n  PointerCalldataBlock.prototype.getDependency = function () {\n    return this._dependency;\n  };\n\n  PointerCalldataBlock.prototype.setAlias = function (block) {\n    this._aliasFor = block;\n\n    this._setName(this.getName() + \" (alias for \" + block.getName() + \")\");\n  };\n\n  PointerCalldataBlock.prototype.getAlias = function () {\n    return this._aliasFor;\n  };\n\n  PointerCalldataBlock.prototype.getRawData = function () {\n    var dependencyRawData = this._dependency.getRawData();\n\n    var rawDataComponents = [];\n    rawDataComponents.push(PointerCalldataBlock.RAW_DATA_START);\n    rawDataComponents.push(dependencyRawData);\n    rawDataComponents.push(PointerCalldataBlock.RAW_DATA_END);\n    var rawData = Buffer.concat(rawDataComponents);\n    return rawData;\n  };\n\n  PointerCalldataBlock.RAW_DATA_START = new Buffer('<');\n  PointerCalldataBlock.RAW_DATA_END = new Buffer('>');\n  PointerCalldataBlock._DEPENDENT_PAYLOAD_SIZE_IN_BYTES = 32;\n  PointerCalldataBlock._EMPTY_HEADER_SIZE = 0;\n  return PointerCalldataBlock;\n}(calldata_block_1.CalldataBlock);\n\nexports.PointerCalldataBlock = PointerCalldataBlock;","map":{"version":3,"sources":["../../../../../src/abi_encoder/calldata/blocks/pointer.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ethUtil = require(\"ethereumjs-util\");\nvar constants_1 = require(\"../../utils/constants\");\nvar calldata_block_1 = require(\"../calldata_block\");\nvar PointerCalldataBlock = /** @class */ (function (_super) {\n    __extends(PointerCalldataBlock, _super);\n    function PointerCalldataBlock(name, signature, parentName, dependency, parent) {\n        var _this = this;\n        var headerSizeInBytes = PointerCalldataBlock._EMPTY_HEADER_SIZE;\n        var bodySizeInBytes = PointerCalldataBlock._DEPENDENT_PAYLOAD_SIZE_IN_BYTES;\n        _this = _super.call(this, name, signature, parentName, headerSizeInBytes, bodySizeInBytes) || this;\n        _this._parent = parent;\n        _this._dependency = dependency;\n        _this._aliasFor = undefined;\n        return _this;\n    }\n    PointerCalldataBlock.prototype.toBuffer = function () {\n        var destinationOffset = this._aliasFor !== undefined ? this._aliasFor.getOffsetInBytes() : this._dependency.getOffsetInBytes();\n        var parentOffset = this._parent.getOffsetInBytes();\n        var parentHeaderSize = this._parent.getHeaderSizeInBytes();\n        var pointer = destinationOffset - (parentOffset + parentHeaderSize);\n        var pointerHex = \"0x\" + pointer.toString(constants_1.constants.HEX_BASE);\n        var pointerBuf = ethUtil.toBuffer(pointerHex);\n        var pointerBufPadded = ethUtil.setLengthLeft(pointerBuf, constants_1.constants.EVM_WORD_WIDTH_IN_BYTES);\n        return pointerBufPadded;\n    };\n    PointerCalldataBlock.prototype.getDependency = function () {\n        return this._dependency;\n    };\n    PointerCalldataBlock.prototype.setAlias = function (block) {\n        this._aliasFor = block;\n        this._setName(this.getName() + \" (alias for \" + block.getName() + \")\");\n    };\n    PointerCalldataBlock.prototype.getAlias = function () {\n        return this._aliasFor;\n    };\n    PointerCalldataBlock.prototype.getRawData = function () {\n        var dependencyRawData = this._dependency.getRawData();\n        var rawDataComponents = [];\n        rawDataComponents.push(PointerCalldataBlock.RAW_DATA_START);\n        rawDataComponents.push(dependencyRawData);\n        rawDataComponents.push(PointerCalldataBlock.RAW_DATA_END);\n        var rawData = Buffer.concat(rawDataComponents);\n        return rawData;\n    };\n    PointerCalldataBlock.RAW_DATA_START = new Buffer('<');\n    PointerCalldataBlock.RAW_DATA_END = new Buffer('>');\n    PointerCalldataBlock._DEPENDENT_PAYLOAD_SIZE_IN_BYTES = 32;\n    PointerCalldataBlock._EMPTY_HEADER_SIZE = 0;\n    return PointerCalldataBlock;\n}(calldata_block_1.CalldataBlock));\nexports.PointerCalldataBlock = PointerCalldataBlock;\n//# sourceMappingURL=pointer.js.map"]},"metadata":{},"sourceType":"script"}